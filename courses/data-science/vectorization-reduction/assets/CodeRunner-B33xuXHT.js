const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/slidev/shiki-RTP5J45j.js","assets/monaco/bundled-types-CLsK2vNO.js","assets/modules/file-saver-BzOOqXCn.js","assets/modules/vue-CTex1tgH.js","assets/monaco/bundled-types-DfXIvR3s.css","assets/modules/shiki-CKVUqrC7.js","assets/modules/shiki-Bxv373Z5.css"])))=>i.map(i=>d[i]);
import{r as x,d as D,G as J,f as m,o as u,af as H,z as U,U as Q,P as G,aP as q,S as W,E as K,ai as Z,i as M,an as X,g as z,t as $,X as b,F as E,ak as I,b as Y,n as ee,H as te,k as ne,e as se,w as ie}from"./modules/vue-CTex1tgH.js";import{l as oe,_ as V,k as ae,n as A}from"./monaco/bundled-types-CLsK2vNO.js";import{a as re,a5 as ce}from"./index-ezSAcK3F.js";import{u as le}from"./slidev/context-_1tYaurk.js";import{_ as ue}from"./slidev/IconButton.vue_vue_type_script_setup_true_lang-FvHYBk4T.js";import"./modules/file-saver-BzOOqXCn.js";import"./modules/shiki-CKVUqrC7.js";const N={};function de(n){return n}var pe=de;let w=null;async function me(){if(w)return w;let n="/pyodide/",t=n+"pyodide.js";try{const s=await fetch(t,{method:"GET"}),i=(s.headers.get("Content-Type")||"").includes("javascript");if(!s.ok||!i)throw new Error("Not valid JS file")}catch{n="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/",t=n+"pyodide.js"}if(await new Promise((s,c)=>{const i=document.createElement("script");i.src=t,i.onload=s,i.onerror=c,document.head.appendChild(i)}),typeof window.loadPyodide!="function")throw new Error(`loadPyodide not available from ${t}`);return w=await window.loadPyodide({indexURL:n}),await w.loadPackage(["numpy","scikit-learn","pandas","matplotlib","micropip"]),await w.runPythonAsync(`
async def _install_plotly():
    import micropip
    await micropip.install("plotly")
await _install_plotly()
`),await w.runPythonAsync(`
import numpy as np
np.set_printoptions(linewidth=10000)
from js import document, URL, Blob, setTimeout

def save_plot(fig, id="monaco-fig", filename="plot.html"):
    fig.write_html(filename, full_html=False, include_plotlyjs='cdn', config={'displayModeBar': False,'responsive': True})
    with open(filename, "r") as f:
        html = f.read()
    blob = Blob.new([html], { "type": "text/html" })
    url = URL.createObjectURL(blob)
    def insert_iframe():
        container = document.getElementById(id)
        if container:
            iframe = document.createElement("iframe")
            iframe.src = url
            iframe.style = "width: 100%; height: 100%; border: none;"
            container.innerHTML = ""
            container.appendChild(iframe)
    def wait_for_target(callback, retries=20):
        if document.getElementById(id):
            callback()
        elif retries > 0:
            setTimeout(lambda: wait_for_target(callback, retries - 1), 100)
    wait_for_target(insert_iframe)
`),w}const fe="/courses/data-science/vectorization-reduction/assets/cmu_movie_summary-BZ5DIi31.csv",_e="/courses/data-science/vectorization-reduction/assets/movie_metadata-eE3iEw3E.csv",he="/courses/data-science/vectorization-reduction/assets/movie_metadata_clean-QULovPml.csv",ve="/courses/data-science/vectorization-reduction/assets/movies-CekC_PaI.csv",ye="/courses/data-science/vectorization-reduction/assets/9kmovies-89YQW5GB.csv",ge="/courses/data-science/vectorization-reduction/assets/9kratings-DLxWZ5yJ.csv",we="/courses/data-science/vectorization-reduction/assets/README-Cyq7KvM_.txt",be="/courses/data-science/vectorization-reduction/assets/links-Cvske5Ai.csv",xe="/courses/data-science/vectorization-reduction/assets/tags-BSdIJN40.csv";function ke(n){return n.split("?")[0]}function Se(n){return n.replace(/^\/public(?=\/)/,"")}const Ee=Object.assign({"/public/data/cmu_movies/cmu_movie_summary.csv":fe,"/public/data/imdb5000/movie_metadata.csv":_e,"/public/data/imdb5000/movie_metadata_clean.csv":he,"/public/data/movies.csv":ve,"/public/data/movieslens9k/9kmovies.csv":ye,"/public/data/movieslens9k/9kratings.csv":ge,"/public/data/movieslens9k/README.txt":we,"/public/data/movieslens9k/links.csv":be,"/public/data/movieslens9k/tags.csv":xe}),Ce=Object.values(Ee).map(n=>Se(ke(n))),O=[];let T=!1;function R(){if(T)return;T=!0;const n=async()=>{const t=O.shift();t?(await t(),n()):T=!1};n()}async function Pe(n,t){const s=t.split("/").pop(),i=await(await fetch(t,{method:"GET",cache:"no-store"})).text(),a=i.slice(0,500).toLowerCase();if(a.includes("<html")||a.includes("doctype html"))throw new Error(`Fetched HTML instead of CSV from ${t}. Check path/base.`);n.FS.writeFile(s,i)}async function je(n){for(const t of Ce)try{await Pe(n,t)}catch(s){console.warn(`[preload] failed ${t}:`,s)}}let P=!1;const B=[];function Oe(){for(;B.length;)O.push(B.shift());R()}const $e=pe(()=>({python:async n=>new Promise(t=>{const s=n.includes("pd.read_csv"),c=async()=>{var d;const i=await me();s&&!P&&await je(i);let a="",r="";i.setStdout({batched:e=>a+=e});try{await i.runPythonAsync(`
def _is_expr(code):
  try:
    compile(code, '<input>', 'eval')
    return True
  except:
    return False
`);const o=[...n.trim().split(`
`)].reverse().find(f=>f.trim())||"",p=/^\s*\w+\s*=/.test(o),l=/^\s*print\(/.test(o);if(await i.runPythonAsync(n),!l&&!p&&o?await i.runPythonAsync(`_is_expr(${JSON.stringify(o)})`):!1){const f=await i.runPythonAsync(`_ = ${o}
_`);((d=f==null?void 0:f.__class__)==null?void 0:d.__name__)==="DataFrame"?r=await i.runPythonAsync("_.to_html()"):f!==void 0&&(a+=f.toString()+`
`)}const h=a.replace(/\n/g,"<br>");t(r?{html:`
<div style="overflow:auto; max-height:300px; border:1px solid #ccc; padding:0.5em;">
  <style>
    table { border-collapse: collapse; width: 100%; font-family: sans-serif; font-size: 8px; }
    th, td { border: 1px solid #ddd; padding: 1px; text-align: left; }
    tr:nth-child(even) { background-color: #f9f9f9; }
    th { background-color: #f2f2f2; font-weight: bold; }
  </style>
  ${r}
</div>`}:{html:`<div style="font-size: 10px; font-family: monospace; overflow-x: auto;">${h}</div>`})}catch(e){t({text:e.toString()})}finally{s&&!P&&(P=!0,setTimeout(()=>{Oe()},5e3))}};P||s?(O.push(c),R()):B.push(c)})})),Ae=[$e],Te=oe(async()=>{const n={javascript:j,js:j,typescript:j,ts:j},{getHighlighter:t}=await V(async()=>{const{getHighlighter:i}=await import("./slidev/shiki-RTP5J45j.js");return{getHighlighter:i}},__vite__mapDeps([0,1,2,3,4,5,6])),s=await t(),c=async(i,a,r)=>{try{const d=n[a];if(!d)throw new Error(`Runner for language "${a}" not found`);return await d(i,{options:r,highlight:s,run:async(e,o)=>await c(e,o,r)})}catch(d){return console.error(d),{error:`${d}`}}};for(const i of Ae){const a=await i(n);Object.assign(n,a)}return{highlight:s,run:c}});function Re(n){const t=x([]),s=e=>t.value.push({error:String(e)}),c=(...e)=>t.value.push(e.map(a)),i=Object.assign({},console);i.info=i.log=i.debug=i.warn=i.error=c,i.clear=()=>t.value.length=0;try{const e=`return async (console, __slidev_import, __slidev_on_error) => {
      try {
        ${d(n)}
      } catch (e) {
        __slidev_on_error(e)
      }
    }`;new Function(e)()(i,o=>{const p=N[o];if(!p)throw new Error(`Module not found: ${o}.
Available modules: ${Object.keys(N).join(", ")}. Please refer to https://sli.dev/custom/config-code-runners#additional-runner-dependencies`);return p},s)}catch(e){s(e)}function a(e){return typeof e=="string"?{text:e}:{text:r(e),highlightLang:"javascript"}}function r(e){var p;let o="";if(e instanceof Error)o=`Error: ${JSON.stringify(e.message)}`;else if(e==null||typeof e=="symbol")o=String(e);else if(Array.isArray(e))o=`[${e.map(r).join(", ")}]`;else if(e instanceof Set){const l=[...e];o=`Set (${e.size}) {${l.map(r).join(", ")}}`}else if(e instanceof Map){const l=[...e.entries()];o=`Map (${e.size}) {${l.map(([_,h])=>`${r(_)} => ${r(h)}`).join(", ")}}`}else if(e instanceof RegExp)o=e.toString();else if(typeof e=="string")o=JSON.stringify(e);else if(typeof e=="object"){const l=((p=e.constructor)==null?void 0:p.name)??"",_=l&&l==="Object"?"":l;o=(_?`${_}: `:"")+JSON.stringify(e,(f,y)=>y===void 0?"__undefined__":y,2).replace(/"__undefined__"/g,"undefined"),o=String(o)}else o=String(e);return o}function d(e){return e=e.replace('import "reflect-metadata"',"").replace('require("reflect-metadata")',""),e=e.replace("export {};",""),e}return t}let C;async function j(n){C??(C=await V(()=>import("./monaco/bundled-types-CLsK2vNO.js").then(s=>s.t),__vite__mapDeps([1,2,3,4]))),n=C.transpileModule(n,{compilerOptions:{module:C.ModuleKind.ESNext,target:C.ScriptTarget.ES2022},transformers:{after:[Be]}}).outputText;const t=/import\s*\((.+)\)/g;return n=n.replace(t,(s,c)=>`__slidev_import(${c})`),Re(n)}function Be(n){const{factory:t}=n,{isImportDeclaration:s,isNamedImports:c,NodeFlags:i}=C;return a=>{var d,e;const r=[...a.statements];for(let o=0;o<r.length;o++){const p=r[o];if(!s(p))continue;let l;const _=(d=p.importClause)==null?void 0:d.namedBindings,h=[];if((e=p.importClause)!=null&&e.name&&h.push(t.createBindingElement(void 0,t.createIdentifier("default"),p.importClause.name)),_)if(c(_)){for(const y of _.elements)h.push(t.createBindingElement(void 0,y.propertyName,y.name));l=t.createObjectBindingPattern(h)}else l=t.createIdentifier(_.name.text);else l=t.createObjectBindingPattern(h);const f=t.createVariableStatement(void 0,t.createVariableDeclarationList([t.createVariableDeclaration(l,void 0,void 0,t.createAwaitExpression(t.createCallExpression(t.createIdentifier("import"),void 0,[p.moduleSpecifier])))],i.Const));r[o]=f}return t.updateSourceFile(a,r)}}const Le=D({__name:"DomElement",props:{element:{}},setup(n){const t=n,s=x();return J(()=>{s.value&&s.value.appendChild(t.element)}),(c,i)=>(u(),m("div",{ref_key:"container",ref:s},null,512))}}),Me={key:0,class:"text-sm text-center opacity-50"},ze={key:1,class:"text-sm text-center opacity-50"},Ie={key:2,class:"text-sm text-center opacity-50"},Ne=["innerHTML"],De={key:1,class:"text-red-500"},Ve={key:3,class:"output-line"},Fe=["innerHTML"],Je={key:2,class:"separator"},He={key:0,class:"absolute right-1 top-1 max-h-full flex gap-1"},Xe=D({__name:"CodeRunner",props:{modelValue:{},lang:{},autorun:{type:[Boolean,String]},height:{},showOutputAt:{type:[null,Boolean,String,Number,Array]},highlightOutput:{type:Boolean},runnerOptions:{}},emits:["update:modelValue"],setup(n,{emit:t}){const s=n,c=t,{isPrintMode:i}=re(),a=H(s,"modelValue",c),{$renderContext:r,$clicksContext:d}=le(),e=U(()=>!["slide","presenter"].includes(r.value)),o=i.value?"once":s.autorun,p=x(o),l=Q(),_=x(0),h=x(),f=x(s.showOutputAt);if(s.showOutputAt){const k=ce();G(()=>{const g=d.calculate(s.showOutputAt);g?(d.register(k,g),q(()=>{f.value=!g.isActive.value})):f.value=!1}),W(()=>d.unregister(k))}const y=ae(200,async()=>{if(e.value)return;const{highlight:k,run:g}=await Te();h.value=k;const v=setTimeout(()=>{p.value=!0},500);l.value=await g(a.value,s.lang,s.runnerOptions??{}),_.value+=1,p.value=!1,clearTimeout(v)});return o==="once"?y():o&&K(a,y,{immediate:!0}),(k,g)=>(u(),m(E,null,[Z(z("div",{class:"relative flex flex-col rounded-b border-t border-main",style:ne({height:s.height}),"data-waitfor":".slidev-runner-output"},[e.value?(u(),m("div",Me,' Code is disabled in the "'+$(b(r))+'" mode ',1)):p.value?(u(),m("div",ze," Running... ")):l.value?(u(),m("div",{key:`run-${_.value}`,class:"slidev-runner-output"},[(u(!0),m(E,null,I(b(A)(te(l.value)),(v,F)=>(u(),m(E,{key:F},["html"in v?(u(),m("div",{key:0,innerHTML:v.html},null,8,Ne)):"error"in v?(u(),m("div",De,$(v.error),1)):"element"in v?(u(),Y(Le,{key:2,element:v.element},null,8,["element"])):(u(),m("div",Ve,[(u(!0),m(E,null,I(b(A)(v),(S,L)=>(u(),m(E,{key:L},[S.highlightLang&&h.value?(u(),m("span",{key:0,class:"highlighted",innerHTML:h.value(S.text,S.highlightLang)},null,8,Fe)):(u(),m("span",{key:1,class:ee(S.class)},$(S.text),3)),L<b(A)(v).length-1?(u(),m("span",Je,",")):M("v-if",!0)],64))),128))]))],64))),128))])):(u(),m("div",Ie," Click the play button to run the code "))],4),[[X,!f.value]]),b(a).trim()?(u(),m("div",He,[se(ue,{class:"w-8 h-8 max-h-full flex justify-center items-center",title:"Run code",onClick:b(y)},{default:ie(()=>g[0]||(g[0]=[z("div",{class:"i-carbon:play"},null,-1)])),_:1},8,["onClick"])])):M("v-if",!0)],64))}});export{Xe as default};
