{% assign course_sort = site.data.teaching | sort: "institution" %}
{% assign course_year = course_sort | where: "year",{{include.year}} %}
{% assign course_inst = course_year | group_by:"institution" %}


{% assign data_str = "" %}
{% for inst in course_inst %}
  {% if forloop.first==false %}
    {% assign data_str = data_str | append: ";" %}
  {% endif %}
  {% for course in course_year %}
    {% if course.institution == inst.name %}
      {% if forloop.first == false %}
        {% assign data_str = data_str | append: "," %}
      {% endif %}
      {% assign data_str = data_str | append: course.hours %}
    {% else %}
      {% if forloop.first == false %}
        {% assign data_str = data_str | append: "," %}
      {% endif %}
      {% assign data_str = data_str | append: "null" %}
    {% endif %}
  {% endfor %}
{% endfor %}
{%- assign data_list = data_str | split: ';' -%}


{%- assign label_list = course_year | map: 'title' -%}
{%- assign inst_list = course_inst | map: 'name' -%}

<a>{{include.parent_id}}</a>


<div style="width:100%"><canvas id="canvas-{{ include.id }}-{{ include.year }}"></canvas></div>
<script>
Chart.defaults.global.defaultFontColor = textcolor;
var ctx = document.getElementById("canvas-{{ include.id }}-{{ include.year }}").getContext("2d");
var myBar = new Chart(ctx, {
                type: 'horizontalBar',
                data: chartData,
                options: barOptions,
                scaleFontColor:textcolor,
            });
    

document.getElementById(idparent).addEventListener('click', function() {
	var idparent = "{{include.parent_id}}"
	console.log(idparent);
	var myBar = new Chart(ctx, {
		type: 'horizontalBar',
		data: chartData,
		options: barOptions,
		scaleFontColor:textcolor,
	    });
});
</script>
